var St=Object.defineProperty,jt=Object.defineProperties;var Dt=Object.getOwnPropertyDescriptors;var ht=Object.getOwnPropertySymbols;var yt=Object.prototype.hasOwnProperty,Lt=Object.prototype.propertyIsEnumerable;var $=(t,n,e)=>n in t?St(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e,C=(t,n)=>{for(var e in n||(n={}))yt.call(n,e)&&$(t,e,n[e]);if(ht)for(var e of ht(n))Lt.call(n,e)&&$(t,e,n[e]);return t},Y=(t,n)=>jt(t,Dt(n));var S=(t,n,e)=>$(t,typeof n!="symbol"?n+"":n,e);var R=(t,n,e)=>new Promise((s,r)=>{var o=h=>{try{a(e.next(h))}catch(u){r(u)}},i=h=>{try{a(e.throw(h))}catch(u){r(u)}},a=h=>h.done?s(h.value):Promise.resolve(h.value).then(o,i);a((e=e.apply(t,n)).next())});import{w as x,d as gt}from"./Cq2FQNBD.js";import{d as I}from"./BbPlWtWr.js";import{y as F}from"./DePUFE4i.js";const nt={Shafi:"shafi",Hanafi:"hanafi"};function vt(t){switch(t){case nt.Shafi:return 1;case nt.Hanafi:return 2;default:throw"Invalid Madhab"}}const G={MiddleOfTheNight:"middleofthenight",SeventhOfTheNight:"seventhofthenight",TwilightAngle:"twilightangle"};class ft{constructor(n,e){this.latitude=n,this.longitude=e}}const U={Nearest:"nearest",Up:"up",None:"none"};function B(t,n){const e=t.getFullYear(),s=t.getMonth(),r=t.getDate()+n,o=t.getHours(),i=t.getMinutes(),a=t.getSeconds();return new Date(e,s,r,o,i,a)}function v(t,n){return j(t,n*60)}function j(t,n){return new Date(t.getTime()+n*1e3)}function O(t,n=U.Nearest){const e=t.getUTCSeconds();let s=e>=30?60-e:-1*e;return n===U.Up?s=60-e:n===U.None&&(s=0),j(t,s)}function ut(t){let n=0;const s=[31,c.isLeapYear(t.getFullYear())?29:28,31,30,31,30,31,31,30,31,30,31];for(let r=0;r<t.getMonth();r++)n+=s[r];return n+=t.getDate(),n}function ct(t){return t instanceof Date&&!isNaN(t.valueOf())}function m(t){return t*Math.PI/180}function _(t){return t*180/Math.PI}function dt(t,n){return t-n*Math.floor(t/n)}function p(t){return dt(t,360)}function Ot(t){return t>=-180&&t<=180?t:t-360*Math.round(t/360)}const et={General:"general",Ahmer:"ahmer",Abyad:"abyad"},c={meanSolarLongitude(t){const n=t,e=280.4664567,s=36000.76983*n,r=3032e-7*Math.pow(n,2),o=e+s+r;return p(o)},meanLunarLongitude(t){const n=t,e=218.3165,s=481267.8813*n,r=e+s;return p(r)},ascendingLunarNodeLongitude(t){const n=t,e=125.04452,s=1934.136261*n,r=.0020708*Math.pow(n,2),o=Math.pow(n,3)/45e4,i=e-s+r+o;return p(i)},meanSolarAnomaly(t){const n=t,e=357.52911,s=35999.05029*n,r=1537e-7*Math.pow(n,2),o=e+s-r;return p(o)},solarEquationOfTheCenter(t,n){const e=t,s=m(n),r=(1.914602-.004817*e-14e-6*Math.pow(e,2))*Math.sin(s),o=(.019993-101e-6*e)*Math.sin(2*s),i=289e-6*Math.sin(3*s);return r+o+i},apparentSolarLongitude(t,n){const e=t,r=n+c.solarEquationOfTheCenter(e,c.meanSolarAnomaly(e)),o=125.04-1934.136*e,i=r-.00569-.00478*Math.sin(m(o));return p(i)},meanObliquityOfTheEcliptic(t){const n=t,e=23.439291,s=.013004167*n,r=1639e-10*Math.pow(n,2),o=5036e-10*Math.pow(n,3);return e-s-r+o},apparentObliquityOfTheEcliptic(t,n){const e=t,s=n,r=125.04-1934.136*e;return s+.00256*Math.cos(m(r))},meanSiderealTime(t){const n=t,e=n*36525+2451545,s=280.46061837,r=360.98564736629*(e-2451545),o=387933e-9*Math.pow(n,2),i=Math.pow(n,3)/3871e4,a=s+r+o-i;return p(a)},nutationInLongitude(t,n,e,s){const r=n,o=e,i=s,a=-17.2/3600*Math.sin(m(i)),h=1.32/3600*Math.sin(2*m(r)),u=.23/3600*Math.sin(2*m(o)),l=.21/3600*Math.sin(2*m(i));return a-h-u+l},nutationInObliquity(t,n,e,s){const r=n,o=e,i=s,a=9.2/3600*Math.cos(m(i)),h=.57/3600*Math.cos(2*m(r)),u=.1/3600*Math.cos(2*m(o)),l=.09/3600*Math.cos(2*m(i));return a+h+u-l},altitudeOfCelestialBody(t,n,e){const s=t,r=n,o=e,i=Math.sin(m(s))*Math.sin(m(r)),a=Math.cos(m(s))*Math.cos(m(r))*Math.cos(m(o));return _(Math.asin(i+a))},approximateTransit(t,n,e){const s=t,r=n,o=e,i=s*-1;return dt((o+i-r)/360,1)},correctedTransit(t,n,e,s,r,o){const i=t,a=n,h=e,u=s,l=r,f=o,d=a*-1,b=p(h+360.985647*i),L=p(c.interpolateAngles(u,l,f,i)),H=Ot(b-d-L)/-360;return(i+H)*24},correctedHourAngle(t,n,e,s,r,o,i,a,h,u,l){const f=t,d=n,b=r,L=o,E=i,H=a,T=h,k=u,J=l,X=e.longitude*-1,Z=Math.sin(m(d))-Math.sin(m(e.latitude))*Math.sin(m(T)),P=Math.cos(m(e.latitude))*Math.cos(m(T)),K=_(Math.acos(Z/P)),N=s?f+K/360:f-K/360,w=p(b+360.985647*N),q=p(c.interpolateAngles(L,E,H,N)),it=c.interpolate(T,k,J,N),at=w-X-q,At=c.altitudeOfCelestialBody(e.latitude,it,at)-d,bt=360*Math.cos(m(it))*Math.cos(m(e.latitude))*Math.sin(m(at)),Tt=At/bt;return(N+Tt)*24},interpolate(t,n,e,s){const r=t-n,o=e-t,i=o-r;return t+s/2*(r+o+s*i)},interpolateAngles(t,n,e,s){const r=p(t-n),o=p(e-t),i=o-r;return t+s/2*(r+o+s*i)},julianDay(t,n,e,s=0){const r=Math.trunc,o=r(n>2?t:t-1),i=r(n>2?n:n+12),a=e+s/24,h=r(o/100),u=r(2-h+r(h/4)),l=r(365.25*(o+4716)),f=r(30.6001*(i+1));return l+f+a+u-1524.5},julianCentury(t){return(t-2451545)/36525},isLeapYear(t){return!(t%4!==0||t%100===0&&t%400!==0)},seasonAdjustedMorningTwilight(t,n,e,s){const r=75+.5209090909090909*Math.abs(t),o=75+19.44/55*Math.abs(t),i=75+32.74/55*Math.abs(t),a=75+48.1/55*Math.abs(t),h=function(){const u=c.daysSinceSolstice(n,e,t);return u<91?r+(o-r)/91*u:u<137?o+(i-o)/46*(u-91):u<183?i+(a-i)/46*(u-137):u<229?a+(i-a)/46*(u-183):u<275?i+(o-i)/46*(u-229):o+(r-o)/91*(u-275)}();return j(s,Math.round(h*-60))},seasonAdjustedEveningTwilight(t,n,e,s,r){let o,i,a,h;r===et.Ahmer?(o=62+17.4/55*Math.abs(t),i=62-7.16/55*Math.abs(t),a=62+5.12/55*Math.abs(t),h=62+19.44/55*Math.abs(t)):r===et.Abyad?(o=75+25.6/55*Math.abs(t),i=75+7.16/55*Math.abs(t),a=75+36.84/55*Math.abs(t),h=75+81.84/55*Math.abs(t)):(o=75+25.6/55*Math.abs(t),i=75+2.05/55*Math.abs(t),a=75-9.21/55*Math.abs(t),h=75+6.14/55*Math.abs(t));const u=function(){const l=c.daysSinceSolstice(n,e,t);return l<91?o+(i-o)/91*l:l<137?i+(a-i)/46*(l-91):l<183?a+(h-a)/46*(l-137):l<229?h+(a-h)/46*(l-183):l<275?a+(i-a)/46*(l-229):i+(o-i)/91*(l-275)}();return j(s,Math.round(u*60))},daysSinceSolstice(t,n,e){let s=0;const r=10,o=c.isLeapYear(n)?173:172,i=c.isLeapYear(n)?366:365;return e>=0?(s=t+r,s>=i&&(s=s-i)):(s=t-o,s<0&&(s=s+i)),s}};class tt{constructor(n){const e=c.julianCentury(n),s=c.meanSolarLongitude(e),r=c.meanLunarLongitude(e),o=c.ascendingLunarNodeLongitude(e),i=m(c.apparentSolarLongitude(e,s)),a=c.meanSiderealTime(e),h=c.nutationInLongitude(e,s,r,o),u=c.nutationInObliquity(e,s,r,o),l=c.meanObliquityOfTheEcliptic(e),f=m(c.apparentObliquityOfTheEcliptic(e,l));this.declination=_(Math.asin(Math.sin(f)*Math.sin(i))),this.rightAscension=p(_(Math.atan2(Math.cos(f)*Math.sin(i),Math.cos(i)))),this.apparentSiderealTime=a+h*3600*Math.cos(m(l+u))/3600}}class D{constructor(n,e){const s=c.julianDay(n.getFullYear(),n.getMonth()+1,n.getDate(),0);this.observer=e,this.solar=new tt(s),this.prevSolar=new tt(s-1),this.nextSolar=new tt(s+1);const r=c.approximateTransit(e.longitude,this.solar.apparentSiderealTime,this.solar.rightAscension),o=-50/60;this.approxTransit=r,this.transit=c.correctedTransit(r,e.longitude,this.solar.apparentSiderealTime,this.solar.rightAscension,this.prevSolar.rightAscension,this.nextSolar.rightAscension),this.sunrise=c.correctedHourAngle(r,o,e,!1,this.solar.apparentSiderealTime,this.solar.rightAscension,this.prevSolar.rightAscension,this.nextSolar.rightAscension,this.solar.declination,this.prevSolar.declination,this.nextSolar.declination),this.sunset=c.correctedHourAngle(r,o,e,!0,this.solar.apparentSiderealTime,this.solar.rightAscension,this.prevSolar.rightAscension,this.nextSolar.rightAscension,this.solar.declination,this.prevSolar.declination,this.nextSolar.declination)}hourAngle(n,e){return c.correctedHourAngle(this.approxTransit,n,this.observer,e,this.solar.apparentSiderealTime,this.solar.rightAscension,this.prevSolar.rightAscension,this.nextSolar.rightAscension,this.solar.declination,this.prevSolar.declination,this.nextSolar.declination)}afternoon(n){const e=Math.abs(this.observer.latitude-this.solar.declination),s=n+Math.tan(m(e)),r=_(Math.atan(1/s));return this.hourAngle(r,!0)}}const V={AqrabBalad:"AqrabBalad",AqrabYaum:"AqrabYaum",Unresolved:"Unresolved"},Mt=.5,Nt=65,z=t=>!isNaN(t.sunrise)&&!isNaN(t.sunset),pt=(t,n,e=1,s=1)=>{if(e>Math.ceil(365/2))return null;const r=new Date(n.getTime());r.setDate(r.getDate()+s*e);const o=B(r,1),i=new D(r,t),a=new D(o,t);return!z(i)||!z(a)?pt(t,n,e+(s>0?0:1),-s):{date:n,tomorrow:o,coordinates:t,solarTime:i,tomorrowSolarTime:a}},wt=(t,n,e)=>{const s=new D(n,Y(C({},t),{latitude:e})),r=B(n,1),o=new D(r,Y(C({},t),{latitude:e}));return!z(s)||!z(o)?Math.abs(e)>=Nt?wt(t,n,e-Math.sign(e)*Mt):null:{date:n,tomorrow:r,coordinates:new ft(e,t.longitude),solarTime:s,tomorrowSolarTime:o}},qt=(t,n,e)=>{const s={date:n,tomorrow:B(n,1),coordinates:e,solarTime:new D(n,e),tomorrowSolarTime:new D(B(n,1),e)};switch(t){case V.AqrabYaum:return pt(e,n)||s;case V.AqrabBalad:{const{latitude:r}=e;return wt(e,n,r-Math.sign(r)*Mt)||s}default:return s}};class M{constructor(n,e=0,s=0,r=0,o=0){S(this,"madhab",nt.Shafi);S(this,"highLatitudeRule",G.MiddleOfTheNight);S(this,"adjustments",{fajr:0,sunrise:0,dhuhr:0,asr:0,maghrib:0,isha:0});S(this,"methodAdjustments",{fajr:0,sunrise:0,dhuhr:0,asr:0,maghrib:0,isha:0});S(this,"polarCircleResolution",V.Unresolved);S(this,"rounding",U.Nearest);S(this,"shafaq",et.General);this.method=n,this.fajrAngle=e,this.ishaAngle=s,this.ishaInterval=r,this.maghribAngle=o,this.method===null&&(this.method="Other")}nightPortions(){switch(this.highLatitudeRule){case G.MiddleOfTheNight:return{fajr:1/2,isha:1/2};case G.SeventhOfTheNight:return{fajr:1/7,isha:1/7};case G.TwilightAngle:return{fajr:this.fajrAngle/60,isha:this.ishaAngle/60};default:throw`Invalid high latitude rule found when attempting to compute night portions: ${this.highLatitudeRule}`}}}const Ct={MuslimWorldLeague(){const t=new M("MuslimWorldLeague",18,17);return t.methodAdjustments.dhuhr=1,t},Egyptian(){const t=new M("Egyptian",19.5,17.5);return t.methodAdjustments.dhuhr=1,t},Karachi(){const t=new M("Karachi",18,18);return t.methodAdjustments.dhuhr=1,t},UmmAlQura(){return new M("UmmAlQura",18.5,0,90)},Dubai(){const t=new M("Dubai",18.2,18.2);return t.methodAdjustments=Y(C({},t.methodAdjustments),{sunrise:-3,dhuhr:3,asr:3,maghrib:3}),t},MoonsightingCommittee(){const t=new M("MoonsightingCommittee",18,18);return t.methodAdjustments=Y(C({},t.methodAdjustments),{dhuhr:5,maghrib:3}),t},NorthAmerica(){const t=new M("NorthAmerica",15,15);return t.methodAdjustments.dhuhr=1,t},Kuwait(){return new M("Kuwait",18,17.5)},Qatar(){return new M("Qatar",18,0,90)},Singapore(){const t=new M("Singapore",20,18);return t.methodAdjustments.dhuhr=1,t.rounding=U.Up,t},Tehran(){return new M("Tehran",17.7,14,0,4.5)},Turkey(){const t=new M("Turkey",18,17);return t.methodAdjustments=Y(C({},t.methodAdjustments),{sunrise:-7,dhuhr:5,asr:4,maghrib:7}),t},Other(){return new M("Other",0,0)}},g={Fajr:"fajr",Sunrise:"sunrise",Dhuhr:"dhuhr",Asr:"asr",Maghrib:"maghrib",Isha:"isha",None:"none"};class A{constructor(n){return this.hours=Math.floor(n),this.minutes=Math.floor((n-this.hours)*60),this.seconds=Math.floor((n-(this.hours+this.minutes/60))*60*60),this}utcDate(n,e,s){return new Date(Date.UTC(n,e,s,this.hours,this.minutes,this.seconds))}}class Yt{constructor(n,e,s){this.coordinates=n,this.date=e,this.calculationParameters=s;let r=new D(e,n),o,i,a,h,u,l,f,d;a=new A(r.transit).utcDate(e.getFullYear(),e.getMonth(),e.getDate()),i=new A(r.sunrise).utcDate(e.getFullYear(),e.getMonth(),e.getDate()),u=new A(r.sunset).utcDate(e.getFullYear(),e.getMonth(),e.getDate());const b=B(e,1);let L=new D(b,n);const E=s.polarCircleResolution;if((!ct(i)||!ct(u)||isNaN(L.sunrise))&&E!==V.Unresolved){const w=qt(E,e,n);r=w.solarTime,L=w.tomorrowSolarTime;const q=[e.getFullYear(),e.getMonth(),e.getDate()];a=new A(r.transit).utcDate(...q),i=new A(r.sunrise).utcDate(...q),u=new A(r.sunset).utcDate(...q)}h=new A(r.afternoon(vt(s.madhab))).utcDate(e.getFullYear(),e.getMonth(),e.getDate());const H=new A(L.sunrise).utcDate(b.getFullYear(),b.getMonth(),b.getDate()),T=(Number(H)-Number(u))/1e3;o=new A(r.hourAngle(-1*s.fajrAngle,!1)).utcDate(e.getFullYear(),e.getMonth(),e.getDate()),s.method==="MoonsightingCommittee"&&n.latitude>=55&&(d=T/7,o=j(i,-d));const k=function(){return s.method==="MoonsightingCommittee"?c.seasonAdjustedMorningTwilight(n.latitude,ut(e),e.getFullYear(),i):(d=s.nightPortions().fajr*T,j(i,-d))}();if((isNaN(o.getTime())||k>o)&&(o=k),s.ishaInterval>0)f=v(u,s.ishaInterval);else{f=new A(r.hourAngle(-1*s.ishaAngle,!0)).utcDate(e.getFullYear(),e.getMonth(),e.getDate()),s.method==="MoonsightingCommittee"&&n.latitude>=55&&(d=T/7,f=j(u,d));const w=function(){return s.method==="MoonsightingCommittee"?c.seasonAdjustedEveningTwilight(n.latitude,ut(e),e.getFullYear(),u,s.shafaq):(d=s.nightPortions().isha*T,j(u,d))}();(isNaN(f.getTime())||w<f)&&(f=w)}if(l=u,s.maghribAngle){const w=new A(r.hourAngle(-1*s.maghribAngle,!0)).utcDate(e.getFullYear(),e.getMonth(),e.getDate());u<w&&f>w&&(l=w)}const J=(s.adjustments.fajr||0)+(s.methodAdjustments.fajr||0),X=(s.adjustments.sunrise||0)+(s.methodAdjustments.sunrise||0),Z=(s.adjustments.dhuhr||0)+(s.methodAdjustments.dhuhr||0),P=(s.adjustments.asr||0)+(s.methodAdjustments.asr||0),K=(s.adjustments.maghrib||0)+(s.methodAdjustments.maghrib||0),N=(s.adjustments.isha||0)+(s.methodAdjustments.isha||0);this.fajr=O(v(o,J),s.rounding),this.sunrise=O(v(i,X),s.rounding),this.dhuhr=O(v(a,Z),s.rounding),this.asr=O(v(h,P),s.rounding),this.sunset=O(u,s.rounding),this.maghrib=O(v(l,K),s.rounding),this.isha=O(v(f,N),s.rounding)}timeForPrayer(n){return n===g.Fajr?this.fajr:n===g.Sunrise?this.sunrise:n===g.Dhuhr?this.dhuhr:n===g.Asr?this.asr:n===g.Maghrib?this.maghrib:n===g.Isha?this.isha:null}currentPrayer(n=new Date){return n>=this.isha?g.Isha:n>=this.maghrib?g.Maghrib:n>=this.asr?g.Asr:n>=this.dhuhr?g.Dhuhr:n>=this.sunrise?g.Sunrise:n>=this.fajr?g.Fajr:g.None}nextPrayer(n=new Date){return n>=this.isha?g.None:n>=this.maghrib?g.Isha:n>=this.asr?g.Maghrib:n>=this.dhuhr?g.Asr:n>=this.sunrise?g.Dhuhr:n>=this.fajr?g.Sunrise:g.Fajr}}function It(t,n,e,s="Karachi"){const r=new ft(n,e),o=Ct[s](),i=new Yt(r,t,o);return{fajr:i.fajr,sunrise:i.sunrise,dhuhr:i.dhuhr,asr:i.asr,maghrib:i.maghrib,isha:i.isha}}function lt(t){const n=new Date,e=[{name:"fajr",time:t.fajr},{name:"dhuhr",time:t.dhuhr},{name:"asr",time:t.asr},{name:"maghrib",time:t.maghrib},{name:"isha",time:t.isha}];for(const r of e)if(r.time>n)return r;const s=new Date(n);return s.setDate(s.getDate()+1),{name:"fajr",time:s}}function mt(t){const n=new Date;if(n.getHours()<8||n<t.fajr)return"dawn";const s=new Date(t.maghrib);return s.setHours(s.getHours()-1),n>=s?"rejuvenation":"preservation"}function Vt(t){const e=t-new Date;if(e<=0)return{hours:0,minutes:0,seconds:0};const s=Math.floor(e/(1e3*60*60)),r=Math.floor(e%(1e3*60*60)/(1e3*60)),o=Math.floor(e%(1e3*60)/1e3);return{hours:s,minutes:r,seconds:o}}function zt(t){return t>=21}function Ft(t){if(!t)return 0;const n=new Date(t),s=Math.floor((new Date-n)/(1e3*60*60*24));return Math.max(0,Math.min(30,s+1))}const W=x(null),y=x(null),st=x(null),rt=x("preservation"),Q=x(new Date().toISOString().split("T")[0]),xt=gt(W,t=>!t||!t.ramadanStartDate?0:Ft(t.ramadanStartDate)),ot=x(null);function Et(){return R(this,null,function*(){const t=yield I.getSettings();W.set(t);const n=new Date,e=It(n,t.location.lat,t.location.lng,t.calculationMethod);st.set(e);const s=mt(e);rt.set(s);const r=lt(e);ot.set(r);const o=n.toISOString().split("T")[0];Q.set(o);const i=yield I.getDayLog(o);y.set(i),setInterval(()=>{const a=F(st);if(a){const h=mt(a);rt.set(h);const u=lt(a);ot.set(u)}},6e4)})}function Ht(t){return R(this,null,function*(){const n=F(y),e=F(Q);n.prayers[t]=!n.prayers[t],yield I.saveDayLog(e,n),y.set(n)})}function Rt(t){return R(this,null,function*(){const n=F(y),e=F(Q);n.quranPages=Math.max(0,t),yield I.saveDayLog(e,n),y.set(n)})}function Ut(t){return R(this,null,function*(){const n=F(Q);yield I.addSadaqah(n,t);const e=yield I.getDayLog(n);y.set(e)})}const Bt=gt([y,W],([t,n])=>{if(!t||!n)return{percentage:0,items:[]};const e=[];let s=0,r=0;const o=Object.values(t.prayers).filter(h=>h===!0).length,i=n.track==="essential"?5:6;if(e.push({name:"Prayers",current:o,goal:i}),s+=o,r+=i,n.track!=="essential"){const h=n.quranGoal||5;e.push({name:"Quran",current:Math.min(t.quranPages,h),goal:h}),s+=Math.min(t.quranPages,h),r+=h}if(n.track==="devoted"){const h=t.sadaqah.length>0?1:0;e.push({name:"Sadaqah",current:h,goal:1}),s+=h,r+=1}return{percentage:r>0?Math.round(s/r*100):0,items:e,completed:s,total:r}}),Wt=Object.freeze(Object.defineProperty({__proto__:null,addSadaqahEntry:Ut,currentDate:Q,currentLog:y,dailyProgress:Bt,focusState:rt,initializeApp:Et,nextPrayer:ot,prayerTimes:st,ramadanDay:xt,settings:W,togglePrayer:Ht,updateQuranPages:Rt},Symbol.toStringTag,{value:"Module"}));export{Ut as a,zt as b,y as c,Bt as d,Wt as e,rt as f,Vt as g,Et as i,ot as n,st as p,xt as r,W as s,Ht as t};
